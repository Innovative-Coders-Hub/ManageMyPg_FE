import{u as S,r as t,e as C,j as e,q as A}from"./index-DZruhiV_.js";import{d as v}from"./dayjs.min-7h3eaHmg.js";import{P}from"./PageHeader-D4m0aPrs.js";const V=(x="")=>x.split(" ").filter(Boolean).slice(0,2).map(c=>c[0]?.toUpperCase()).join("")||"?";function T(){const x=S(),[c,f]=t.useState(""),d=c.trim().toLowerCase(),[p,j]=t.useState([]),[i,N]=t.useState(!1),[o,y]=t.useState(!1),[w]=C(),h=w.get("pgId");t.useEffect(()=>{if(!h)return;async function s(){try{const a=await A(h);j(Array.isArray(a)?a:[])}catch(a){console.error(a),j([])}}s()},[h]);const b=t.useMemo(()=>p.map(s=>{const a=s.vacated===!0;return{id:s.id,tenant:{name:s.name,phone:s.mobileNumber,email:s.email,start:s.dateOfJoining,end:s.dateOfVacate},bedId:s.bedId,vacated:a,rent:s.rentResponse?.[0]||null}}),[p]),r=t.useMemo(()=>{const s=b.filter(a=>{const m=a.vacated;return!!(!i&&!o||!m&&i||m&&o)});return d?s.filter(a=>{const m=(a.tenant?.name||"").toLowerCase(),M=(a.tenant?.phone||"").toLowerCase();return m.includes(d)||M.includes(d)}):s},[d,b,i,o]),n=20,[l,u]=t.useState(1),g=Math.max(1,Math.ceil(r.length/n));t.useEffect(()=>{u(1)},[d,i,o,r.length]);const k=r.slice((l-1)*n,l*n);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(P,{title:"Tenants",subtitle:e.jsx("span",{className:"hidden sm:inline",children:"Search by name or mobile number."}),children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 w-full sm:max-w-md sm:justify-end",children:[e.jsxs("label",{className:"relative flex-1 hidden sm:block",children:[e.jsx("span",{className:"sr-only",children:"Search"}),e.jsx("input",{className:"placeholder:italic placeholder:text-gray-400 block bg-white w-full border border-gray-200 rounded-md py-2 pl-10 pr-3 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-400",placeholder:"Search name or mobileâ€¦",value:c,onChange:s=>f(s.target.value)}),e.jsxs("svg",{className:"w-4 h-4 absolute left-3 top-2.5 text-gray-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5","aria-hidden":!0,children:[e.jsx("path",{d:"M21 21l-4.35-4.35"}),e.jsx("circle",{cx:"11",cy:"11",r:"6"})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:i,onChange:s=>N(s.target.checked),className:"h-4 w-4 rounded border-gray-300 text-emerald-600 focus:ring-emerald-400"}),e.jsx("span",{className:"text-gray-700",children:"Active"})]}),e.jsxs("label",{className:"inline-flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:o,onChange:s=>y(s.target.checked),className:"h-4 w-4 rounded border-gray-300 text-emerald-600 focus:ring-emerald-400"}),e.jsx("span",{className:"text-gray-700",children:"Vacated"})]})]})]})}),e.jsx("div",{className:"sm:hidden",children:e.jsxs("label",{className:"relative block",children:[e.jsx("span",{className:"sr-only",children:"Search"}),e.jsx("input",{className:"placeholder:italic placeholder:text-gray-400 block bg-white w-full border border-gray-200 rounded-md py-2 pl-10 pr-3 text-sm focus:outline-none focus:ring-2 focus:ring-emerald-400",placeholder:"Search name or mobileâ€¦",value:c,onChange:s=>f(s.target.value)}),e.jsxs("svg",{className:"w-4 h-4 absolute left-3 top-2.5 text-gray-400",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5","aria-hidden":!0,children:[e.jsx("path",{d:"M21 21l-4.35-4.35"}),e.jsx("circle",{cx:"11",cy:"11",r:"6"})]})]})}),e.jsx("div",{className:"mt-2 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:r.length===0?e.jsx("div",{className:"col-span-full rounded-xl border border-dashed p-6 text-center text-gray-600",children:"No tenants found. Adjust filters or search term."}):k.map(s=>{const a=s.tenant||{};return s.history,e.jsx("div",{className:"rounded-2xl border p-4 bg-white shadow-sm transition hover:bg-gradient-to-br hover:from-emerald-50 hover:to-sky-50 hover:border-emerald-200 hover:shadow-md",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`h-12 w-12 flex items-center justify-center rounded-lg text-white font-bold ${s.vacated?"bg-gray-400":"bg-emerald-600"}`,children:V(a.name)}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:a.name||"â€”"}),e.jsx("div",{className:"text-xs text-gray-500",children:a.mobileNumber||a.email||"â€”"})]}),e.jsx("div",{className:"text-xs",children:e.jsx("span",{className:"px-3 py-1 rounded-full bg-gray-100 border text-gray-700",children:s.vacated?"Vacated":"Active"})})]}),e.jsxs("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-2 gap-4 text-xs",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-emerald-600",children:"ðŸ“…"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Joined"}),e.jsx("div",{className:"font-medium text-emerald-700",children:a.start?v(a.start).format("DD MMM YYYY"):"â€”"})]})]}),s.vacated&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-rose-600",children:"ðŸšª"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-gray-500",children:"Vacated"}),e.jsx("div",{className:"font-medium text-rose-700",children:a.end?v(a.end).format("DD MMM YYYY"):"â€”"})]})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-gray-500",children:s.vacated?"Vacated":"Active"}),e.jsx("button",{onClick:()=>s.bedId&&x(`/beds/${s.bedId}`),className:"px-3 py-1 rounded-lg bg-gradient-to-br from-emerald-600 to-sky-600 text-white text-xs font-medium hover:from-emerald-700 hover:to-sky-700",children:"View"})]})]})]})},s.id)})}),r.length>n&&e.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Showing ",(l-1)*n+1,"â€“",Math.min(l*n,r.length)," of"," ",r.length," tenants"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>u(s=>Math.max(1,s-1)),disabled:l===1,className:"px-3 py-1 rounded-lg border text-sm disabled:opacity-50",children:"Previous"}),e.jsxs("div",{className:"text-sm",children:["Page ",l," / ",g]}),e.jsx("button",{onClick:()=>u(s=>Math.min(g,s+1)),disabled:l===g,className:"px-3 py-1 rounded-lg border text-sm disabled:opacity-50",children:"Next"})]})]})]})}export{T as default};
