import{e as Y,u as C,r as n,j as e}from"./index-H6XvjGiV.js";import{P as M}from"./PageHeader-BEIWCjxH.js";import{s as P}from"./sampleData-CzbAm5hk.js";import{d as j}from"./dayjs.min-rE223ni6.js";function y({label:o,value:x,onChange:m,children:i}){return e.jsxs("label",{className:"block",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:o}),e.jsx("select",{value:x,onChange:d=>m(d.target.value),className:"w-full p-2 border rounded-md",children:i})]})}function E(){const[o,x]=Y(),m=C(),i=P.owners||[],[d,v]=n.useState(i),r=o.get("filter")||"all",[a,N]=n.useState(o.get("state")||"all"),[l,f]=n.useState(o.get("city")||"all"),b=n.useMemo(()=>{const s=new Set(i.map(t=>t.state).filter(Boolean));return["all",...Array.from(s).sort()]},[i]),h=n.useMemo(()=>{const s=a==="all"?i:i.filter(c=>c.state===a),t=new Set(s.map(c=>c.city).filter(Boolean));return["all",...Array.from(t).sort()]},[i,a]);n.useEffect(()=>{l!=="all"&&!h.includes(l)&&f("all")},[a,l,h]),n.useEffect(()=>{const s=new URLSearchParams(o);r!=="all"?s.set("filter",r):s.delete("filter"),a&&a!=="all"?s.set("state",a):s.delete("state"),l&&l!=="all"?s.set("city",l):s.delete("city"),x(s)},[r,a,l]);function u(s){const t=new URLSearchParams(o);s==="all"?t.delete("filter"):t.set("filter",s),x(t)}const w=n.useMemo(()=>d.filter(s=>!(r!=="all"&&s.status!==r||a!=="all"&&s.state!==a||l!=="all"&&s.city!==l)),[d,r,a,l]),g=n.useMemo(()=>({total:d.length,approved:d.filter(s=>s.status==="approved").length,pending:d.filter(s=>s.status==="pending").length}),[d]);function A(s,t){v(c=>c.map(p=>{if(p.id!==s)return p;const S=j().format("YYYY-MM-DD");return{...p,status:t,approvedAt:t==="approved"?p.approvedAt||S:void 0}}))}return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{children:e.jsx(M,{title:"Owners",subtitle:"Manage registered owners and filter by state/city/status"})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded shadow-sm border",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Total registered"}),e.jsx("div",{className:"text-2xl font-bold",children:g.total})]}),e.jsxs("div",{className:"bg-white p-4 rounded shadow-sm border",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Approved"}),e.jsx("div",{className:"text-2xl font-bold",children:g.approved})]}),e.jsxs("div",{className:"bg-white p-4 rounded shadow-sm border",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Pending"}),e.jsx("div",{className:"text-2xl font-bold",children:g.pending})]})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs("div",{className:"bg-white p-4 rounded shadow-sm border",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>u("all"),className:`px-3 py-1 rounded ${r==="all"?"bg-indigo-600 text-white":"bg-gray-100"}`,children:"All"}),e.jsx("button",{onClick:()=>u("approved"),className:`px-3 py-1 rounded ${r==="approved"?"bg-indigo-600 text-white":"bg-gray-100"}`,children:"Approved"}),e.jsx("button",{onClick:()=>u("pending"),className:`px-3 py-1 rounded ${r==="pending"?"bg-indigo-600 text-white":"bg-gray-100"}`,children:"Pending"})]}),e.jsx("div",{className:"ml-auto w-40",children:e.jsx(y,{label:"State",value:a,onChange:N,children:b.map(s=>e.jsx("option",{value:s,children:s},s))})}),e.jsx("div",{className:"w-40",children:e.jsx(y,{label:"City",value:l,onChange:f,children:h.map(s=>e.jsx("option",{value:s,children:s},s))})})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{className:"text-left text-xs text-gray-500",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2",children:"Name"}),e.jsx("th",{className:"py-2",children:"Email"}),e.jsx("th",{className:"py-2",children:"State"}),e.jsx("th",{className:"py-2",children:"City"}),e.jsx("th",{className:"py-2",children:"Registered"}),e.jsx("th",{className:"py-2",children:"Approved"}),e.jsx("th",{className:"py-2",children:"Status"}),e.jsx("th",{className:"py-2",children:"Actions"})]})}),e.jsx("tbody",{children:w.map(s=>e.jsxs("tr",{className:"border-t",children:[e.jsx("td",{className:"py-2",children:s.name}),e.jsx("td",{className:"py-2 text-gray-600",children:s.email}),e.jsx("td",{className:"py-2",children:s.state}),e.jsx("td",{className:"py-2",children:s.city}),e.jsx("td",{className:"py-2 text-gray-500",children:j(s.registeredAt).format("YYYY-MM-DD")}),e.jsx("td",{className:"py-2",children:s.approvedAt?j(s.approvedAt).format("YYYY-MM-DD"):"—"}),e.jsxs("td",{className:"py-2",children:[s.status==="approved"&&e.jsx("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-700",children:"Approved"}),s.status==="pending"&&e.jsx("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-800",children:"Pending"}),s.status==="rejected"&&e.jsx("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-semibold bg-red-100 text-red-700",children:"Rejected"}),!s.status&&e.jsx("span",{className:"inline-block px-2 py-1 rounded-full text-xs font-semibold bg-gray-100 text-gray-700",children:"—"})]}),e.jsx("td",{className:"py-2",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{defaultValue:"",onChange:t=>{const c=t.target.value;c&&(A(s.id,c),t.target.selectedIndex=0)},className:"px-2 py-1 rounded bg-gray-50 text-xs border",children:[e.jsx("option",{value:"",disabled:!0,children:"Actions"}),e.jsx("option",{value:"approved",children:"Approve"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"rejected",children:"Reject"})]},s.status),e.jsx("button",{onClick:()=>m(`/admin/owner/${s.id}`),className:"ml-2 px-2 py-1 rounded bg-gray-50 text-xs hover:bg-indigo-50 hover:text-indigo-700",children:"View"})]})})]},s.id))})]})})]})})]})}export{E as default};
