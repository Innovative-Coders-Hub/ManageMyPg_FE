import{r as a,j as e}from"./index-H6XvjGiV.js";import{P as N}from"./PageHeader-BEIWCjxH.js";import{d as f}from"./dayjs.min-rE223ni6.js";function v(r){return f(r).isValid()?f(r).format("DD MMM YYYY"):"—"}function w(r="offers"){const[s,u]=a.useState(()=>{try{return JSON.parse(localStorage.getItem(r))??[]}catch{return[]}});return a.useEffect(()=>{try{localStorage.setItem(r,JSON.stringify(s))}catch{}},[r,s]),[s,u]}function O({open:r,initial:s=null,onClose:u,onSave:d}){const[c,i]=a.useState(s?.title??""),[m,g]=a.useState(s?.mode??"text"),[x,p]=a.useState(s?.content??""),[h,j]=a.useState(s?.expireAt?f(s.expireAt).format("YYYY-MM-DD"):"");return a.useEffect(()=>{r&&(i(s?.title??""),g(s?.mode??"text"),p(s?.content??""),j(s?.expireAt?f(s.expireAt).format("YYYY-MM-DD"):""))},[r,s]),r?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"absolute inset-0 bg-black/30",onClick:u}),e.jsxs("div",{className:"relative w-full max-w-xl mx-4 rounded-2xl border bg-white shadow-xl",children:[e.jsx("div",{className:"px-6 py-4 border-b bg-gradient-to-r from-indigo-50 to-blue-50 rounded-t-2xl",children:e.jsx("div",{className:"text-lg font-semibold",children:s?"Edit Offer":"Create Offer"})}),e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("label",{className:"block text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Title"}),e.jsx("input",{value:c,onChange:n=>i(n.target.value),className:"mt-1 w-full px-3 py-2 rounded-lg border outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("label",{className:"block text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Type"}),e.jsxs("select",{value:m,onChange:n=>g(n.target.value),className:"mt-1 w-full px-3 py-2 rounded-lg border outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"text",children:"Text"}),e.jsx("option",{value:"image",children:"Image (URL)"})]})]}),m==="text"?e.jsxs("label",{className:"block text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Text"}),e.jsx("textarea",{value:x,onChange:n=>p(n.target.value),rows:4,className:"mt-1 w-full px-3 py-2 rounded-lg border outline-none focus:ring-2 focus:ring-indigo-500"})]}):e.jsxs("label",{className:"block text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Image URL"}),e.jsx("input",{value:x,onChange:n=>p(n.target.value),className:"mt-1 w-full px-3 py-2 rounded-lg border outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("label",{className:"block text-sm",children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Expiry date"}),e.jsx("input",{type:"date",value:h,onChange:n=>j(n.target.value),className:"mt-1 w-full px-3 py-2 rounded-lg border outline-none focus:ring-2 focus:ring-indigo-500"})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:u,className:"px-4 py-2 rounded-lg border hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:()=>d({title:c.trim(),mode:m,content:x.trim(),expireAt:h?f(h).endOf("day").toISOString():null}),className:"px-4 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700",children:s?"Save":"Create"})]})]})]})]}):null}function A(){const[r,s]=w(),[u,d]=a.useState(!1),[c,i]=a.useState(null),[m,g]=a.useState(null),x=t=>{g(t),setTimeout(()=>g(null),2500)};function p(t){const l=new Date().toISOString(),o={id:`offer_${Date.now()}`,...t,createdAt:l};s(b=>[o,...b]),d(!1),x("Offer created")}function h(t,l){const o=new Date().toISOString(),b={id:`offer_${Date.now()}`,...l,createdAt:o};s(y=>[b,...y]),x("Offer reposted")}function j(t){confirm("Delete this offer?")&&(s(l=>l.filter(o=>o.id!==t)),x("Offer deleted"))}const n=a.useMemo(()=>r.map(t=>{const l=t.expireAt?f(t.expireAt):null,o=f(),b=l?l.isBefore(o,"day"):!1,y=l?l.diff(o,"day"):null;return{...t,expired:b,days:y}}),[r]);return e.jsxs("div",{className:"w-full max-w-screen-2xl px-4 py-6 space-y-4",children:[e.jsx(N,{title:"Tenant Offers",subtitle:"Create and manage offers for tenants"}),e.jsx("div",{className:"flex items-center justify-end",children:e.jsx("button",{onClick:()=>{i(null),d(!0)},className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700",children:"Create Offer"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.length===0&&e.jsx("div",{className:"rounded-2xl border border-dashed p-6 text-center text-sm text-gray-600",children:"No offers yet. Create your first offer."}),n.map(t=>e.jsxs("div",{className:`rounded-2xl border p-4 ${t.expired?"opacity-70":""}`,children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:t.title}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Expires: ",t.expireAt?v(t.expireAt):"—"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-xs ${t.expired?"bg-red-50 text-red-700 border border-red-100":"bg-green-50 text-green-700 border border-green-100"}`,children:t.expired?"Expired":"Active"}),e.jsx("div",{className:"text-xs text-gray-500 mt-2",children:t.days!==null?t.days>=0?`Expires in ${t.days}d`:`Expired ${Math.abs(t.days)}d ago`:"No expiry"})]})]}),e.jsx("div",{className:"mt-3 text-sm text-gray-700",children:t.mode==="image"?t.content?e.jsx("img",{src:t.content,alt:t.title,className:"w-full rounded"}):e.jsx("div",{className:"text-xs text-gray-400",children:"No image URL"}):e.jsx("div",{className:"whitespace-pre-wrap",children:t.content})}),e.jsxs("div",{className:"mt-4 flex items-center gap-2 justify-end",children:[e.jsx("button",{onClick:()=>{i(t),d(!0)},className:"px-3 py-1 rounded border text-sm hover:bg-gray-50",children:"Edit"}),e.jsx("button",{onClick:()=>{i({...t,__repost:!0}),d(!0)},className:"px-3 py-1 rounded border text-sm hover:bg-gray-50",children:"Repost"}),e.jsx("button",{onClick:()=>j(t.id),className:"px-3 py-1 rounded border text-sm text-red-600 hover:bg-red-50",children:"Delete"})]})]},t.id))]}),e.jsx(O,{open:u,initial:c,onClose:()=>{d(!1),i(null)},onSave:t=>{if(c&&c.__repost){h(c.id,t),i(null),d(!1);return}p(t)}}),m&&e.jsx("div",{className:"fixed bottom-4 right-4 px-4 py-2 rounded-lg bg-gray-900 text-white text-sm",children:m})]})}export{A as default};
